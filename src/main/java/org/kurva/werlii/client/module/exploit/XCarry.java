package org.kurva.werlii.client.module.exploit;

import net.minecraft.network.packet.c2s.play.CloseHandledScreenC2SPacket;
import org.kurva.werlii.client.module.Module;
import org.kurva.werlii.client.setting.BooleanSetting;
import org.lwjgl.glfw.GLFW;

public class XCarry extends Module {
    private final BooleanSetting forceS;
    private final BooleanSetting visualS;
    private final BooleanSetting storeS;
    
    private boolean wasEnabled = false;
    
    public XCarry() {
        super("XCarry", "Allows storing items in crafting slots", Category.EXPLOIT);
        this.setKeyCode(GLFW.GLFW_KEY_UNKNOWN);
        this.registerKeybinding("Werlii Exploit");
        
        forceS = new BooleanSetting("Force", "Force enable even if server tries to close inventory", this, true);
        visualS = new BooleanSetting("Visual", "Show items in crafting slots", this, true);
        storeS = new BooleanSetting("Store", "Automatically store items in crafting slots", this, false);
        
        addSetting(forceS);
        addSetting(visualS);
        addSetting(storeS);
    }
    
    @Override
    public void onEnable() {
        super.onEnable();
        wasEnabled = true;
    }
    
    @Override
    public void onDisable() {
        super.onDisable();
        
        if (mc.player != null && wasEnabled) {
            mc.getNetworkHandler().sendPacket(new CloseHandledScreenC2SPacket(0));
            wasEnabled = false;
        }
    }
    
    public boolean shouldCancelPacket(CloseHandledScreenC2SPacket packet) {
        return isEnabled() && forceS.getValue() && packet.getSyncId() == 0;
    }
    
    public boolean shouldShowCraftingSlots() {
        return isEnabled() && visualS.getValue();
    }
    
    @Override
    public void onTick() {
        if (mc.player == null || !storeS.getValue()) return;
        
    }
}

